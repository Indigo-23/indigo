function indigo(){return window.indigo_app=window.indigo_app||{module:angular.module("indigo.application",["indigo.templates","ui.router","ui.bootstrap","LocalStorageModule","angular-loading-bar"]),state:{}},window.indigo_app}angular.module("indigo.templates",[]).run(["$templateCache",function(a){"use strict"}]),angular.element(document).ready(function(){var a=angular.bootstrap(document.body,["indigo.application"]);a.get("$rootScope")}),indigo().module.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(a,b,c){b.html5Mode(!0).hashPrefix("#"),c.when("","/"),c.when("/join","/join/signin"),angular.forEach(indigo().state,function(b,c){a.state(c,b)})}]),indigo().module.run(["authService",function(a){a.fillAuthData()}]),indigo().module.factory("authInterceptorService",["$q","$injector","$location","localStorageService",function(a,b,c,d){return{request:function(a){a.headers=a.headers||{};var b=d.get("authorizationData");return b&&(a.headers.Authorization="Bearer "+b.token),a},responseError:function(a){}}}]),indigo().module.factory("authService",["$http","$q","localStorageService",function(a,b,c){return{authentication:{isAuth:!1,userName:""},login:function(d){var e=this,f="grant_type=password&username="+d.userName+"&password="+d.password,g=b.defer();return a.post("/token",f,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a){c.set("authorizationData",{token:a.access_token,userName:d.userName,refreshToken:a.refresh_token}),e.authentication.isAuth=!0,e.authentication.userName=d.userName,g.resolve(a)}).error(function(a,b){e.logOut(),g.reject(a)}),g.promise},logOut:function(){var a=this;c.remove("authorizationData"),a.authentication.isAuth=!1,a.authentication.userName=""},fillAuthData:function(){var a=this,b=c.get("authorizationData");b&&(a.authentication.isAuth=!0,a.authentication.userName=b.userName)}}}]),indigo().state.layout={views:{"@":{templateUrl:"template/layout.html",controller:["$scope","$state","$location","authService",function(a,b,c,d){a.isNavMenuCollapsed=!0,a.$on("$stateChangeSuccess",function(b,e,f,g,h){a.isNavMenuCollapsed=!0,a.authentication=d.authentication,a.logOut=function(){d.logOut(),c.path("/join/signin")}})}]}}},indigo().state.home={parent:"layout",url:"/",views:{"content@layout":{templateUrl:"template/home/index.html",controller:["$scope",function(a){}]}}},indigo().state.join={parent:"layout",url:"/join",views:{"content@layout":{templateUrl:"template/join/index.html",controller:["$scope",function(a){}]}}},indigo().state["join.signin"]={url:"/signin",views:{"content@join":{templateUrl:"template/join/signin.html",controller:["$scope","$location","authService",function(a,b,c){a.error={},a.signinModel={userName:"demo",password:"demo",state:{IsValid:!0,Errors:{},addError:function(a,b,c){this.IsValid=!1,this.Errors[a]={title:b,error:c}},clear:function(){a.signinModel.state.IsValid=!0,a.signinModel.state.Errors={}}}},a.signin=function(){a.signinModel.state.clear(),""===a.signinModel.userName&&a.signinModel.state.addError("userName","Логин","Данное попе обязательно для заполнения"),""===a.signinModel.password&&a.signinModel.state.addError("password","Пароль","Данное попе обязательно для заполнения"),a.signinModel.state.IsValid&&c.login(a.signinModel).then(function(a){b.path("/")},function(b){a.signinModel.state.addError("form","Неправильный логин или пароль",'Возможно у вас выбрана другая раскладка клавиатуры или нажата клавиша "Caps Lock"')})}}]}}},indigo().state["join.signup"]={url:"/signup",views:{"content@join":{templateUrl:"template/join/signup.html",controller:["$scope","$uibModal",function(a,b){a.ShowLegal=function(){var a=b.open({animation:!0,keyboard:!0,templateUrl:"template/legal/modal.html",size:"lg",controller:["$scope",function(b){b.close=function(){a.close()}}]})}}]}}};